window.solveCollision=function(t,n){n=n||{};var r=d3.quadtree().x(function(t){return t.xp}).y(function(t){return t.yp});void 0!==n.extent&&r.extent(n.extent);var a=0;t.forEach(function(t){t.xp=t.x0,t.yp=t.y0,void 0!==n.r0&&(t.r0=n.r0),t.r=t.r0,t.xMin=t.x0-t.r0,t.xMax=t.x0+t.r0,t.yMin=t.y0-t.r0,t.yMax=t.y0+t.r0;var g,v=[];function o(t){var e=g.xp-t.xp,n=g.yp-t.yp,r=e*e+n*n,i=g.r+t.r;if(r<i*i){var o,a,u,s,l,c,h={r:t.r,xp:t.xp,yp:t.yp,from:t};v.push(h);var f=Math.sqrt(r);a=g.r<h.r?(o=h,g):(o=g,h);var p=o.r,d=a.r,y=(p+d+f)/4;if(0<r)l=(a.xp-o.xp)/f,c=(a.yp-o.yp)/f;else{var m=2*Math.PI*Math.random();l=Math.cos(m),c=Math.sin(m)}s=y<=d?(u=y/p,y/d):(u=(p-d+f)/(2*p),1),o.r*=u,a.r*=s,o.xp+=(u-1)*p*l,o.yp+=(u-1)*p*c,a.xp+=(1-s)*d*l,a.yp+=(1-s)*d*c,o.xMin=o.xp-o.r,o.xMax=o.xp+o.r,o.yMin=o.yp-o.r,o.yMax=o.yp+o.r,a.xMin=a.xp-a.r,a.xMax=a.xp+a.r,a.yMin=a.yp-a.r,a.yMax=a.yp+a.r}}r.visit((g=t,function(t,e,n,r,i){if(!t.length)for(;g.xMax>t.data.xMin&&g.xMin<t.data.xMax&&g.yMax>t.data.yMin&&g.yMin<t.data.yMax&&o(t.data),t=t.next;);return e>g.xMax+a||r+a<g.xMin||n>g.yMax+a||i+a<g.yMin})),a=Math.max(a,t.r),r.removeAll(v.map(function(t){return t.from}));var e=v.map(function(t){var e=t.from;return e.xp=t.xp,e.yp=t.yp,e.r=t.r,e.xMin=t.xMin,e.xMax=t.xMax,e.yMin=t.yMin,e.yMax=t.yMax,e});e.push(t),r.addAll(e)}),void 0!==n.zoom&&t.forEach(function(t){t.cache=t.cache||{},t.cache[n.zoom]={x:t.xp,y:t.yp,r:t.r}});var e=0;return t.forEach(function(t){e=Math.max(e,t.r)}),r.rMax=e,r};